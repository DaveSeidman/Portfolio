function makeSound(e,t){var o={};return o.volumeNode=actx.createGain(),o.panNode=actx.createStereoPanner?actx.createStereoPanner():actx.createPanner(),o.delayNode=actx.createDelay(),o.feedbackNode=actx.createGain(),o.filterNode=actx.createBiquadFilter(),o.convolverNode=actx.createConvolver(),o.soundNode=null,o.buffer=null,o.source=null,o.loop=!1,o.playing=!1,o.loadHandler=void 0,o.panValue=0,o.volumeValue=1,o.startTime=0,o.startOffset=0,o.playbackRate=1,o.echo=!1,o.delayValue=.3,o.feebackValue=.3,o.filterValue=0,o.reverb=!1,o.reverbImpulse=null,o.play=function(){o.startTime=actx.currentTime,o.soundNode=actx.createBufferSource(),o.soundNode.buffer=o.buffer,o.soundNode.playbackRate.value=this.playbackRate,o.soundNode.connect(o.volumeNode),o.reverb===!1?o.volumeNode.connect(o.panNode):(o.volumeNode.connect(o.convolverNode),o.convolverNode.connect(o.panNode),o.convolverNode.buffer=o.reverbImpulse),o.panNode.connect(actx.destination),o.echo&&(o.feedbackNode.gain.value=o.feebackValue,o.delayNode.delayTime.value=o.delayValue,o.filterNode.frequency.value=o.filterValue,o.delayNode.connect(o.feedbackNode),o.filterValue>0?(o.feedbackNode.connect(o.filterNode),o.filterNode.connect(o.delayNode)):o.feedbackNode.connect(o.delayNode),o.volumeNode.connect(o.delayNode),o.delayNode.connect(o.panNode)),o.soundNode.loop=o.loop,o.soundNode.start(0,o.startOffset%o.buffer.duration),o.playing=!0},o.pause=function(){o.playing&&(o.soundNode.stop(0),o.startOffset+=actx.currentTime-o.startTime,o.playing=!1)},o.restart=function(){o.playing&&o.soundNode.stop(0),o.startOffset=0,o.play()},o.playFrom=function(e){o.playing&&o.soundNode.stop(0),o.startOffset=e,o.play()},o.setEcho=function(e,t,a){void 0===e&&(e=.3),void 0===t&&(t=.3),void 0===a&&(a=0),o.delayValue=e,o.feebackValue=t,o.filterValue=a,o.echo=!0},o.setReverb=function(e,t,a){void 0===e&&(e=2),void 0===t&&(t=2),void 0===a&&(a=!1),o.reverbImpulse=impulseResponse(e,t,a,actx),o.reverb=!0},o.fade=function(e,t){o.playing&&(o.volumeNode.gain.linearRampToValueAtTime(o.volumeNode.gain.value,actx.currentTime),o.volumeNode.gain.linearRampToValueAtTime(e,actx.currentTime+t))},o.fadeIn=function(e){o.volumeNode.gain.value=0,o.fade(1,e)},o.fadeOut=function(e){o.fade(0,e)},Object.defineProperties(o,{volume:{get:function(){return o.volumeValue},set:function(e){o.volumeNode.gain.value=e,o.volumeValue=e},enumerable:!0,configurable:!0},pan:{get:function(){return actx.createStereoPanner?o.panNode.pan.value:o.panValue},set:function(e){if(actx.createStereoPanner)o.panNode.pan.value=e;else{var t=e,a=0,n=1-Math.abs(t);o.panNode.setPosition(t,a,n),o.panValue=e}},enumerable:!0,configurable:!0}}),o.load=function(){var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.addEventListener("load",function(){actx.decodeAudioData(a.response,function(e){o.buffer=e,o.hasLoaded=!0,t&&t()},function(e){throw new Error("Audio could not be decoded: "+e)})}),a.send()},o.load(),o}function soundEffect(e,t,o,a,n,r,i,c,u,d,l,p,s){function f(e){var t=actx.createConvolver();t.buffer=impulseResponse(s[0],s[1],s[2],actx),e.connect(t),t.connect(b)}function v(e){var t=actx.createGain(),o=actx.createDelay(),a=actx.createBiquadFilter();o.delayTime.value=p[0],t.gain.value=p[1],p[2]&&(a.frequency.value=p[2]),o.connect(t),p[2]?(t.connect(a),a.connect(o)):t.connect(o),e.connect(o),o.connect(b)}function y(e){e.gain.value=0,e.gain.linearRampToValueAtTime(0,actx.currentTime+i),e.gain.linearRampToValueAtTime(n,actx.currentTime+i+t)}function m(e){e.gain.linearRampToValueAtTime(n,actx.currentTime+t+i),e.gain.linearRampToValueAtTime(0,actx.currentTime+i+t+o)}function x(e){var a=e.frequency.value;u?(e.frequency.linearRampToValueAtTime(a,actx.currentTime+i),e.frequency.linearRampToValueAtTime(a+c,actx.currentTime+i+t+o)):(e.frequency.linearRampToValueAtTime(a,actx.currentTime+i),e.frequency.linearRampToValueAtTime(a-c,actx.currentTime+i+t+o))}function N(){var e=actx.createOscillator(),a=actx.createOscillator(),r=actx.createGain(),i=actx.createGain();r.gain.value=n,i.gain.value=n,e.connect(r),r.connect(actx.destination),a.connect(i),i.connect(actx.destination),e.type="sawtooth",a.type="sawtooth",e.frequency.value=h+l,a.frequency.value=h-l,t>0&&(y(r),y(i)),o>0&&(m(r),m(i)),c>0&&(x(e),x(a)),p&&(v(r),v(i)),s&&(f(r),f(i)),A(e),A(a)}function A(e){e.start(actx.currentTime+i)}void 0===e&&(e=200),void 0===t&&(t=0),void 0===o&&(o=1),void 0===a&&(a="sine"),void 0===n&&(n=1),void 0===r&&(r=0),void 0===i&&(i=0),void 0===c&&(c=0),void 0===u&&(u=!1),void 0===d&&(d=0),void 0===l&&(l=0),void 0===p&&(p=void 0),void 0===s&&(s=void 0);var T,C,b;T=actx.createOscillator(),C=actx.createGain(),b=actx.createStereoPanner?actx.createStereoPanner():actx.createPanner(),T.connect(C),C.connect(b),b.connect(actx.destination),C.gain.value=n,actx.createStereoPanner?b.pan.value=r:b.setPosition(r,0,1-Math.abs(r)),T.type=a;var h,w=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};h=d>0?w(e-d/2,e+d/2):e,T.frequency.value=h,t>0&&y(C),m(C),c>0&&x(T),p&&v(C),s&&f(C),l>0&&N(),A(T)}function impulseResponse(e,t,o,a){for(var n=a.sampleRate*e,r=a.createBuffer(2,n,a.sampleRate),i=r.getChannelData(0),c=r.getChannelData(1),u=0;n>u;u++){var d;d=o?n-u:u,i[u]=(2*Math.random()-1)*Math.pow(1-d/n,t),c[u]=(2*Math.random()-1)*Math.pow(1-d/n,t)}return r}function keyboard(e){var t={};return t.code=e,t.isDown=!1,t.isUp=!0,t.press=void 0,t.release=void 0,t.downHandler=function(e){e.keyCode===t.code&&(t.isUp&&t.press&&t.press(),t.isDown=!0,t.isUp=!1),e.preventDefault()},t.upHandler=function(e){e.keyCode===t.code&&(t.isDown&&t.release&&t.release(),t.isDown=!1,t.isUp=!0),e.preventDefault()},window.addEventListener("keydown",t.downHandler.bind(t),!1),window.addEventListener("keyup",t.upHandler.bind(t),!1),t}!function(){"use strict";function e(e){e&&(e.setTargetAtTime||(e.setTargetAtTime=e.setTargetValueAtTime))}window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext,AudioContext.prototype.hasOwnProperty("createGain")||(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),AudioContext.prototype.hasOwnProperty("createDelay")||(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var t=this.internal_createGain();return e(t.gain),t},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(t){var o=t?this.internal_createDelay(t):this.internal_createDelay();return e(o.delayTime),o},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var t=this.internal_createBufferSource();return t.start||(t.start=function(e,t,o){t||o?this.noteGrainOn(e,t,o):this.noteOn(e)}),t.stop||(t.stop=t.noteOff),e(t.playbackRate),t},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var t=this.internal_createDynamicsCompressor();return e(t.threshold),e(t.knee),e(t.ratio),e(t.reduction),e(t.attack),e(t.release),t},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var t=this.internal_createBiquadFilter();return e(t.frequency),e(t.detune),e(t.Q),e(t.gain),t},AudioContext.prototype.hasOwnProperty("createOscillator")&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var t=this.internal_createOscillator();return t.start||(t.start=t.noteOn),t.stop||(t.stop=t.noteOff),e(t.frequency),e(t.detune),t}))}(window);var actx=new AudioContext,sounds={toLoad:0,loaded:0,audioExtensions:["mp3","ogg","wav","webm"],whenLoaded:void 0,load:function(e){var t=this;t.toLoad=e.length,e.forEach(function(e){var o=e.split(".").pop();if(-1!==t.audioExtensions.indexOf(o)){var a=makeSound(e,t.loadHandler.bind(t));a.name=e,t[a.name]=a}})},loadHandler:function(){var e=this;e.loaded+=1,e.toLoad===e.loaded&&(e.toLoad=0,e.loaded=0,e.whenLoaded())}};